# Optical Flow + Mamba Model Configuration

# Model Architecture
MODEL_NAME: optical_flow_mamba
ARCHITECTURE: video_patch_embedding_with_mamba

# Input Configuration
INPUT_CHANNELS: 1
NUM_FRAMES: 4
IMG_SIZE: 224
PATCH_SIZE: 16

# Model Dimensions
EMBED_DIM: 256
NUM_FPS_POINTS: 32
NUM_NPS_POINTS: 64

# Mamba Configuration
MAMBA_D_STATE: 64
MAMBA_D_CONV: 4
MAMBA_EXPAND: 2
MAMBA_BIDIRECTIONAL: true

# Output Configuration
OUTPUT_DIM: 6  # 6-DOF pose
NUM_PAIRS: 3

# Training Parameters
BATCH_SIZE: 4  # Reduced for memory efficiency
LEARNING_RATE: 0.0001
WEIGHT_DECAY: 0.0001
NUM_EPOCHS: 150
OPTIMIZER: adamw

# Loss Configuration
LOSS_TYPE: point_focused
POINT_LOSS_WEIGHT: 10.0
MSE_LOSS_WEIGHT: 0.05
CORRELATION_LOSS_WEIGHT: 0.02
VELOCITY_LOSS_WEIGHT: 0.02

# Scheduler
SCHEDULER_TYPE: reduce_on_plateau
SCHEDULER_FACTOR: 0.5
SCHEDULER_PATIENCE: 15

# Data Configuration
DATA_PATH: ./data/Freehand_US_data_train_2025
SAMPLE_RANGE: 1
NUM_SAMPLES: 4

# Optical Flow Configuration
FLOW_LEVELS: 3
ADAPTIVE_FLOW_FUSION: true

# Checkpointing
SAVE_FREQUENCY: 10
VAL_FREQUENCY: 1
SAVE_PATH: ./results/optical_flow_mamba_model

# Logging
USE_TENSORBOARD: true
INFO_FREQUENCY: 50

# Device
GPU: 0
NUM_WORKERS: 2
PIN_MEMORY: false  # Disabled for memory efficiency

# Random Seed
RANDOM_SEED: 42

# Target Performance
TARGET_POINT_DISTANCE: 0.2  # mm (clinical accuracy target)
